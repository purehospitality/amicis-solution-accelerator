# IKEA Mobile App Deployment Guide

## Overview

The IKEA Scan & Go mobile app is published to **Expo Application Services (EAS)**, which hosts the app on cloud servers. Your team can test the app via **Expo Go** without your computer running.

## Prerequisites

1. **Expo Account**: Create a free account at https://expo.dev
2. **EAS CLI**: Already installed globally via `npm install -g eas-cli`
3. **Expo Go App**: Team members need to install from:
   - iOS: App Store ‚Üí "Expo Go"
   - Android: Play Store ‚Üí "Expo Go"

## First-Time Setup

### Step 1: Login to EAS

```powershell
eas login
```

Enter your Expo account credentials.

### Step 2: Initialize Project (If Not Already Done)

```powershell
cd C:\Users\GudniVilmundarson\amicis-solution-accelerator\mobile-ikea
eas project:init
```

This creates a project on Expo's servers and updates `app.json` with the project ID.

## Publishing Updates

### Quick Method (Recommended)

Run the deployment script:

```powershell
.\scripts\deploy-mobile-app.ps1
```

The script will:
1. Check if you're logged in
2. Ask for an update message
3. Let you choose preview (testing) or production channel
4. Upload your app to Expo's cloud
5. Show a QR code for team access

### Manual Method

From the `mobile-ikea` directory:

**For testing:**
```powershell
eas update --branch preview --message "Description of changes"
```

**For production:**
```powershell
eas update --branch production --message "Release v1.0"
```

## How Team Members Access the App

After publishing, share the QR code or URL with your team:

1. **Install Expo Go** on their phone
2. **Scan the QR code** shown after publishing OR
3. **Paste the URL** (format: `exp://u.expo.dev/[project-id]?channel-name=preview`) into Expo Go

The app will download and run - even when your computer is OFF! ‚úÖ

## Update Workflow

```
1. Make changes to mobile-ikea code
   ‚Üì
2. Test locally: npx expo start
   ‚Üì
3. Publish update: .\scripts\deploy-mobile-app.ps1
   ‚Üì
4. Team gets update automatically on next app launch
```

## Channels Explained

- **preview**: For team testing, internal development
- **production**: For wider release, stable versions

You can have both active simultaneously with different versions.

## Configuration Files

### `mobile-ikea/app.json`
- Contains app metadata, permissions, owner info
- `extra.apiBaseUrl`: Points to Azure backend API
- `extra.eas.projectId`: Auto-generated by `eas project:init`

### `mobile-ikea/eas.json`
- Defines build and update profiles
- `preview` and `production` channels configured

## Important Notes

### ‚úÖ What's Cloud-Hosted
- Your JavaScript/React Native code ‚Üí Expo's CDN
- App assets (icons, images) ‚Üí Expo's servers
- Updates are instant (no app store approval needed)

### üîó What Connects to Azure
- Backend API calls ‚Üí `http://api.4.157.44.54.nip.io`
- Authentication service ‚Üí Azure AKS node-auth-service
- Database ‚Üí Azure Cosmos DB

### ‚ö†Ô∏è HTTPS Requirement
Current backend uses HTTP. For production, enable HTTPS:
```powershell
# Update ingress with Let's Encrypt certificate
kubectl apply -f infra/k8s/letsencrypt-issuer.yaml
kubectl apply -f infra/k8s/ingress.yaml
```

Then update `services/api.ts` to use `https://` URL.

## Troubleshooting

### "Not logged in" error
```powershell
eas login
```

### "Project not initialized" error
```powershell
cd mobile-ikea
eas project:init
```

### Updates not showing up
- Updates only apply on app restart
- Close and reopen Expo Go app
- Swipe down to reload in app

### Team can't access the app
- Ensure they're using the correct QR code/URL
- Check they have Expo Go installed
- Verify the channel name matches (preview vs production)

## Cost

- **EAS Update**: Free for first 50 users
- **EAS Build**: 30 free Android builds/month (not needed for Expo Go testing)
- **Hosting**: Expo's servers (no Azure cost for mobile app bundle)

## Next Steps

1. **Login**: Run `eas login`
2. **Initialize**: Run `eas project:init` in mobile-ikea folder
3. **Publish**: Run `.\scripts\deploy-mobile-app.ps1`
4. **Share**: Send QR code to team

The app will be accessible 24/7 via Expo Go! üöÄ
